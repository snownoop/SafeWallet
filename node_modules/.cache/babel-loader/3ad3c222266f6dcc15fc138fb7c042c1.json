{"ast":null,"code":"var _jsxFileName = \"/Users/Raid/Mastering_Ethereum/DevelopingFirstDapp/Testing/src/erc20/ModalAllowance.js\";\nimport React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport '../Modal.css';\n\nconst ModalTrigger = ({\n  handleSubmit,\n  handleInputChange,\n  errors\n}) => React.createElement(\"form\", {\n  id: \"AllowanceForm\",\n  onSubmit: handleSubmit,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 6\n  },\n  __self: this\n}, React.createElement(\"input\", {\n  type: \"text\",\n  name: \"ownerPub\",\n  onChange: handleInputChange,\n  className: \"smartInput\",\n  placeholder: \"Owner Public Key\",\n  required: true,\n  minLength: \"42\",\n  maxLength: \"42\",\n  pattern: \"0x\\\\w+\",\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 7\n  },\n  __self: this\n}), React.createElement(\"button\", {\n  type: \"submit\",\n  className: \"smartButton\",\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 9\n  },\n  __self: this\n}, \"check allowance\"));\n\nconst ModalContent = ({\n  closeModal,\n  modalRef,\n  onKeyDown,\n  onClickAway,\n  children\n}) => {\n  return ReactDOM.createPortal(React.createElement(\"aside\", {\n    className: \"c-modal-cover\",\n    onKeyDown: onKeyDown,\n    onClick: onClickAway,\n    tabIndex: \"0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 13\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"c-modal-safety\",\n    ref: modalRef,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 14\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    className: \"c-modal__close\",\n    onClick: closeModal,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 15\n    },\n    __self: this\n  }, React.createElement(\"svg\", {\n    className: \"c-modal__close-icon\",\n    viewBox: \"0 0 40 40\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 16\n    },\n    __self: this\n  }, React.createElement(\"path\", {\n    d: \"M 10,10 L 30,30 M 30,10 L 10,30\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 16\n    },\n    __self: this\n  }))), React.createElement(\"div\", {\n    className: \"c-modal__body\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 18\n    },\n    __self: this\n  }, children))), document.body);\n};\n\nclass ModalTokenAllowance extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleInputChange = event => {\n      event.preventDefault();\n      const _event$target = event.target,\n            name = _event$target.name,\n            value = _event$target.value;\n\n      switch (name) {\n        case 'ownerPub':\n          if (event.target.validity.tooShort) {\n            event.target.setCustomValidity(\"Public key has to be 42 characters\");\n          } else if (event.target.validity.patternMismatch) {\n            event.target.setCustomValidity(\"Public key has to start with '0x'\");\n          } else {\n            event.target.setCustomValidity(\"\");\n          }\n\n          break;\n\n        default:\n          break;\n      }\n\n      this.setState({\n        [name]: value\n      });\n    };\n\n    this.handleSubmit = event => {\n      event.preventDefault();\n      this.checkAllowance(this.state.ownerPub, this.props.multisigERC20Address);\n    };\n\n    this.openModal = () => {\n      this.setState({\n        isOpen: true\n      });\n    };\n\n    this.closeModal = () => {\n      this.setState({\n        isOpen: false\n      });\n    };\n\n    this.onKeyDown = event => {\n      return event.keyCode === 27 && this.closeModal();\n    };\n\n    this.onClickAway = event => {\n      if (this.modalNode && this.modalNode.contains(event.target)) return;\n      this.closeModal();\n    };\n\n    this.checkAllowance = (ownerPub, multisigERC20Address) => {\n      let modal = this;\n      let token = this.props.token;\n      console.log(ownerPub);\n      console.log(multisigERC20Address);\n      console.log(token.address);\n      console.log(token);\n      token.methods.allowance(ownerPub, multisigERC20Address).call({\n        from: ownerPub\n      }).then(allowance => {\n        modal.setState({\n          allowance: allowance,\n          allowanceReceipt: true\n        });\n        modal.openModal();\n      });\n    };\n\n    this.state = {\n      allowance: '',\n      ownerPub: '',\n      isOpen: false,\n      allowanceReceipt: false\n    };\n  }\n\n  render() {\n    return React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, React.createElement(ModalTrigger, {\n      handleSubmit: this.handleSubmit,\n      handleInputChange: this.handleInputChange,\n      errors: this.state.errors,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }), this.state.isOpen && React.createElement(ModalContent, {\n      closeModal: this.closeModal,\n      onKeyDown: this.onKeyDown,\n      onClickAway: this.onClickAway,\n      modalRef: n => this.modalNode = n,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, this.state.allowanceReceipt ? React.createElement(\"p\", {\n      className: \"modalTextTx\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, \"Current contract allowance is: \", this.state.allowance) : null));\n  }\n\n}\n\nexport default ModalTokenAllowance;","map":{"version":3,"sources":["/Users/Raid/Mastering_Ethereum/DevelopingFirstDapp/Testing/src/erc20/ModalAllowance.js"],"names":["React","Component","ReactDOM","ModalTrigger","handleSubmit","handleInputChange","errors","ModalContent","closeModal","modalRef","onKeyDown","onClickAway","children","createPortal","document","body","ModalTokenAllowance","constructor","props","event","preventDefault","target","name","value","validity","tooShort","setCustomValidity","patternMismatch","setState","checkAllowance","state","ownerPub","multisigERC20Address","openModal","isOpen","keyCode","modalNode","contains","modal","token","console","log","address","methods","allowance","call","from","then","allowanceReceipt","render","n"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport '../Modal.css';\n\nconst ModalTrigger = ({handleSubmit, handleInputChange, errors}) => \n        <form id=\"AllowanceForm\" onSubmit={handleSubmit}>\n          <input type=\"text\" name=\"ownerPub\" onChange={handleInputChange} className=\"smartInput\" placeholder=\"Owner Public Key\"\n            required minLength=\"42\" maxLength=\"42\" pattern=\"0x\\w+\"/> \n          <button type=\"submit\" className=\"smartButton\">check allowance</button>\n        </form>;\nconst ModalContent = ({closeModal, modalRef, onKeyDown, onClickAway, children}) => {\n  return ReactDOM.createPortal(\n    <aside className=\"c-modal-cover\" onKeyDown={onKeyDown} onClick={onClickAway} tabIndex=\"0\">\n      <div className=\"c-modal-safety\" ref={modalRef}>\n        <button className=\"c-modal__close\" onClick={closeModal}>\n          <svg className=\"c-modal__close-icon\" viewBox=\"0 0 40 40\"><path d=\"M 10,10 L 30,30 M 30,10 L 10,30\"></path></svg>\n        </button>\n        <div className=\"c-modal__body\">\n          {children}\n        </div>\n     </div>\n    </aside>,\n    document.body\n  );\n};\n\nclass ModalTokenAllowance extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      allowance: '',\n      ownerPub: '',\n      isOpen: false,\n      allowanceReceipt: false,\n      }\n  }\n\n  handleInputChange = (event) => {\n    event.preventDefault();\n    const { name, value } = event.target;\n\n    switch (name) {\n    case 'ownerPub':\n      if (event.target.validity.tooShort) {\n        event.target.setCustomValidity(\"Public key has to be 42 characters\");\n      } else if (event.target.validity.patternMismatch) {\n        event.target.setCustomValidity(\"Public key has to start with '0x'\");\n      } else {\n        event.target.setCustomValidity(\"\");\n      }  \n      break; \n    default:\n      break;\n    }\n    this.setState({ [name]: value });\n  }\n\n  handleSubmit = (event) => {\n    event.preventDefault();\n    this.checkAllowance(this.state.ownerPub, this.props.multisigERC20Address);\n  }\n  \n  openModal = () => {\n  this.setState({ \n    isOpen: true, \n    });\n  };\n\n  closeModal = () => {\n  this.setState({ \n    isOpen: false, \n    });\n  };\n\n  onKeyDown = (event) => {\n  return event.keyCode === 27 && this.closeModal();\n  }\n  \n  onClickAway = (event) => {\n    if (this.modalNode && this.modalNode.contains(event.target)) return;\n    this.closeModal();\n  };\n\n  checkAllowance = (ownerPub, multisigERC20Address) => {\n    let modal = this;\n    let token = this.props.token;\n    console.log(ownerPub);\n    console.log(multisigERC20Address);\n    console.log(token.address);\n    console.log(token);\n    token.methods.allowance(ownerPub, multisigERC20Address).call({ from: ownerPub }).then( allowance => {\n\n        modal.setState({ \n          allowance: allowance,\n          allowanceReceipt: true\n        });\n        modal.openModal();\n      }\n    )\n  }\n\n  render() {\n\n    return (\n      <span>\n       <ModalTrigger \n        handleSubmit={this.handleSubmit} \n        handleInputChange={this.handleInputChange}\n        errors={this.state.errors}/>\n       {\n        this.state.isOpen && \n        <ModalContent \n          closeModal={this.closeModal} \n          onKeyDown={this.onKeyDown}\n          onClickAway={this.onClickAway}\n          modalRef={n => this.modalNode = n}> \n          {this.state.allowanceReceipt ? \n            <p className=\"modalTextTx\">Current contract allowance is: {this.state.allowance}\n            </p> \n            : null} \n          \n        </ModalContent>\n       }\n      </span>\n    );\n  }\n}\n\nexport default ModalTokenAllowance;"]},"metadata":{},"sourceType":"module"}